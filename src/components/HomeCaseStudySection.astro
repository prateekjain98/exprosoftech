---
import CaseStudyCarousel from "./CaseStudyCarousel";
import { sanityClient } from "sanity:client";
import { createQueries } from "@/lib/utils/hostnameFIltering";

// Get hostname for filtering
const hostname = Astro.url.hostname;
const queries = createQueries(hostname);

// Fetch the top 3 case studies with hostname-aware filtering
const caseStudiesQuery = `${queries.caseStudies(3)} {
  title,
  "slug": slug.current,
  category,
  description,
  excerpt,
  industry,
  duration,
  "logo": logo.asset->url,
  "featuredImage": featuredImage.asset->url,
  publishedAt,
  services,
  isLive
}`;

const caseStudies = await sanityClient.fetch(caseStudiesQuery);
---

<CaseStudyCarousel caseStudies={caseStudies} client:load /> 